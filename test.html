<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тест на стиль привязанности</title>
    <style>
        /* Все стили остаются такими же как в предыдущей версии */
        /* ... */
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Тест на стиль привязанности</h1>
            <p class="subtitle">Определите ваш тип эмоциональных связей в отношениях</p>
        </header>
        
        <main>
            <div id="test-container" class="card">
                <!-- Интерфейс теста без изменений -->
            </div>
            
            <div id="results-container" class="results-container">
                <!-- Контейнер результатов будет заполняться динамически -->
            </div>
        </main>
    </div>

    <script>
        // Вопросы теста (без изменений)
        const questions = [
            "Мне комфортно, когда кто-то эмоционально близок ко мне, и я не боюсь, что меня обидят или бросят.",
            // ... остальные 23 вопроса
        ];
        
        // Классификация вопросов по шкалам
        const secureQuestions = [0, 4, 9, 14, 19, 23];    // Индексы вопросов для надежной привязанности
        const anxiousQuestions = [2, 5, 11, 16, 17, 20];  // Индексы вопросов для тревожной привязанности
        const avoidantQuestions = [3, 7, 8, 12, 15, 21];  // Индексы вопросов для избегающей привязанности
        
        // Элементы DOM (без изменений)
        // ...
        
        // Переменные состояния
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(0);
        
        // Функция для расчета результатов
        function calculateResults() {
            let secureScore = 0;
            let anxiousScore = 0;
            let avoidantScore = 0;
            
            // Расчет баллов по шкалам
            secureQuestions.forEach(index => {
                secureScore += answers[index] || 0;
            });
            
            anxiousQuestions.forEach(index => {
                anxiousScore += answers[index] || 0;
            });
            
            avoidantQuestions.forEach(index => {
                avoidantScore += answers[index] || 0;
            });
            
            // Нормализация баллов (максимум 30)
            secureScore = Math.round((secureScore / 30) * 100);
            anxiousScore = Math.round((anxiousScore / 30) * 100);
            avoidantScore = Math.round((avoidantScore / 30) * 100);
            
            // Определение типа привязанности
            let attachmentType = "";
            
            if (anxiousScore > 60 && avoidantScore > 60) {
                attachmentType = "Тревожно-избегающий (дезорганизованный)";
            } else if (anxiousScore > avoidantScore && anxiousScore > secureScore) {
                attachmentType = "Тревожный";
            } else if (avoidantScore > anxiousScore && avoidantScore > secureScore) {
                attachmentType = "Избегающий";
            } else if (secureScore > anxiousScore && secureScore > avoidantScore) {
                attachmentType = "Безопасный (надежный)";
            } else {
                attachmentType = "Смешанный";
            }
            
            return {
                secureScore,
                anxiousScore,
                avoidantScore,
                attachmentType
            };
        }

        // Функция показа результатов
        function showResults() {
            const results = calculateResults();
            
            // Генерация HTML результатов
            const resultsHTML = `
                <div class="result-card">
                    <h2 class="result-title">Ваши результаты</h2>
                    
                    <div class="score-container">
                        <div class="score-card">
                            <div class="score-title">Надежная привязанность</div>
                            <div class="score-value">${results.secureScore}</div>
                            <div class="score-max">из 100 баллов</div>
                        </div>
                        
                        <div class="score-card">
                            <div class="score-title">Тревожная привязанность</div>
                            <div class="score-value">${results.anxiousScore}</div>
                            <div class="score-max">из 100 баллов</div>
                        </div>
                        
                        <div class="score-card">
                            <div class="score-title">Избегающая привязанность</div>
                            <div class="score-value">${results.avoidantScore}</div>
                            <div class="score-max">из 100 баллов</div>
                        </div>
                    </div>
                    
                    <div class="result-type">
                        <h3 class="list-title">Ваш тип привязанности: <span style="color:#b21f1f">${results.attachmentType}</span></h3>
                        ${getTypeDescription(results.attachmentType)}
                    </div>
                    
                    <div class="copy-container">
                        <button id="copy-btn" class="btn">Копировать результаты</button>
                    </div>
                </div>
            `;
            
            resultsContainer.innerHTML = resultsHTML;
            testContainer.style.display = 'none';
            resultsContainer.style.display = 'block';
            resultsContainer.scrollIntoView({ behavior: 'smooth' });
            
            // Добавляем обработчик кнопки копирования
            document.getElementById('copy-btn').addEventListener('click', () => {
                copyResults(results);
            });
        }

        // Функция для получения описания типа
        function getTypeDescription(type) {
            const descriptions = {
                "Тревожно-избегающий (дезорганизованный)": `
                    <p>Данный тип формируется как следствие травматичного опыта в отношениях и характеризуется 
                    противоречивыми импульсами: сильным желанием близости и одновременным страхом быть уязвимым.</p>
                    <div class="characteristics">
                        <h3 class="list-title">Ключевые характеристики</h3>
                        <ul>
                            <li><strong>Двойной конфликт</strong>: сочетание страха отвержения и трудностей с открытостью в стрессе</li>
                            <li><strong>Гипернезависимость</strong>: предпочтение справляться с трудностями в одиночку</li>
                            <li><strong>Страх уязвимости</strong>: сложности с выражением чувств, склонность "закрываться"</li>
                        </ul>
                    </div>
                    <div class="recommendations">
                        <h3 class="list-title">Рекомендации</h3>
                        <ul>
                            <li>При тревоге спрашивайте себя: "Это реальность или прошлый опыт?"</li>
                            <li>При желании закрыться говорите партнеру: "Мне нужна пауза 20 минут"</li>
                            <li>Обратитесь к терапии привязанности для проработки травм</li>
                        </ul>
                    </div>
                `,
                "Тревожный": `
                    <p>Для этого типа характерны сильное желание близости и страх быть брошенным. 
                    Вы можете испытывать тревогу, когда партнер проявляет независимость.</p>
                    <!-- остальное описание -->
                `,
                "Избегающий": `
                    <p>Этот тип характеризуется дистанцированием в отношениях, трудностями с выражением чувств 
                    и предпочтением сохранять эмоциональную независимость.</p>
                    <!-- остальное описание -->
                `,
                "Безопасный (надежный)": `
                    <p>Вы чувствуете себя комфортно как в близости, так и в автономии. 
                    Способны открыто выражать свои потребности и эмоции.</p>
                    <!-- остальное описание -->
                `,
                "Смешанный": `
                    <p>Ваши результаты показывают сочетание нескольких стилей привязанности. 
                    Это может быть ситуативной реакцией или отражением разных аспектов ваших отношений.</p>
                    <!-- остальное описание -->
                `
            };
            
            return descriptions[type] || "<p>Не удалось определить описание для вашего типа.</p>";
        }

        // Функция копирования результатов
        function copyResults(results) {
            const resultText = `📌 РЕЗУЛЬТАТЫ ТЕСТА НА СТИЛЬ ПРИВЯЗАННОСТИ

🔢 БАЛЛЫ:
• Надежная привязанность: ${results.secureScore}/100
• Тревожная привязанность: ${results.anxiousScore}/100
• Избегающая привязанность: ${results.avoidantScore}/100

❗ ВАШ ТИП: ${results.attachmentType}

💡 ОСНОВНЫЕ ХАРАКТЕРИСТИКИ:
${getTextDescription(results.attachmentType)}`;

            navigator.clipboard.writeText(resultText)
                .then(() => {
                    const copyBtn = document.getElementById('copy-btn');
                    copyBtn.textContent = "✓ Скопировано!";
                    setTimeout(() => {
                        copyBtn.textContent = "Копировать результаты";
                    }, 2000);
                });
        }

        // Инициализация теста (без изменений)
        // ...
        
        // Запуск теста при загрузке страницы
        window.addEventListener('DOMContentLoaded', initTest);
    </script>
</body>
</html>
